<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>IT_TF1319_4</title>
    <script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>
    <script>$(function (){sagecell.makeSagecell({inputLocation:'div.compute',evalButtonText:'Run'});});</script>
  </head>
  <style>
  @import url('https://fonts.googleapis.com/css?family=Orbitron');
  h1, h2 {color:#3636ff; font-family:'Orbitron'; text-shadow:5px 5px 5px #aaa;}
  p, a {color:darkblue; font-size:120%; text-shadow:5px 5px 5px #aaa;}
  .sagecell .CodeMirror-scroll {min-height:3em; max-height:38em;}
  </style>  
  <body>
  <h1>&#x1F4D1; &nbsp;IT. TF1319. Standard Calculation 4</h1>
  <h2>Create code for the next tasks</h2>
  <p>1. Create a program for solving the equation $f(x)=0$ on the segment [A, B] up to $10^{-4}$</p> 
  <p>using the method of sequential approximation and dividing the segment in half.</p>
  <p>2. Create a program for calculating values of the function $F(X,Z)$</p>
  <p>for N values of X (with the start position X_0 and the step HX)</p>
  <p>and for M values of Z (with the start position Z_0 and the step HZ).</p>
  <p>3. Create a program for calculating sums of the series and values of the corresponding function</p>
  <p>for the variable X (with the start position X_0, the end position X_N, and the step value H).</p>
<div class="compute"><script>
# sage / task 1
def find_root(f,a,b,e):
    if sign(f(a))==sign(f(b)):
        print('The segment does not possible to use for this decision method')
    else:
        while b-a>e:
            ab=a+(b-a)/2; print([f(a).n(),f(ab).n(),f(b).n()])
            if sign(f(a))!=sign(f(ab)):
                if f(ab)==0: break
                b=ab
            else:
                a=ab
    print('f(x)=0 => x≈%.10f'%ab)
G(x)=x^3; A,B=-.1,.1; E=10^(-4)
find_root(G,A,B,E)
F(x)=log(20/sqrt(.009))-1.5*(exp(x/3)+exp(-x/3))-x; A,B=0,2; E=10^(-4)
find_root(F,A,B,E)
</script></div><br/>
<div class="compute"><script>
# sage / task 2
def create_table(f,x0,hx,n,z0,hz,m):
    t=[['n','m','x','z','f(x,z)=','f(x,z)≈']]
    for i in [1..n]:
        for j in [1..m]:
            x,z=x0+(i-1)*hx,z0+(j-1)*hz
            t.append([i,j,x,z,f(x,z),f(x,z).n()])
    return(table(t))
f(x,z)=(log(sqrt(pi))+abs(2-x))/(3.3-1/z)+z^(2/3)*cos(x^2)
create_table(f,6.7,.1,4,3.3,.2,3)
</script></div><br/>
<div class="compute"><script>
# sage / task 3
var('k'); controlf(x)=2*x-x*exp(-x^2)-sin(x)
sumf(x,n)=sum(sign(-1)^(k+1)*x^(2*k+1)*(1/factorial(k)+1/factorial(2*k+1)),k,1,n)
def nplot(n):
    sumline=[[x,sumf(x,n).n()] for x in [.05,.1,..,1.05]]
    controlline=[[x,controlf(x).n()] for x in [.05,.1,..,1.05]]
    (list_plot(sumline,size=50,legend_label='sum function',title='n=%d'%n)+\
     list_plot(controlline,color='red',legend_label='control function')).show(gridlines=True)
nplot(3); nplot(5)
</script></div><br/>
<div class="compute"><script>
# python / task 1
import sympy as sp
def find_root(f,a,b,e):
    if sp.sign(f(a))==sp.sign(f(b)):
      print('The segment does not possible to use for this decision method')
    else:
      print('Iteration steps')
      while b-a>e:
        ab=a+(b-a)/2; print([f(a),f(ab),f(b)])
        if sp.sign(f(a))!=sp.sign(f(ab)):
          if f(ab)==0: break
          b=ab
        else:
          a=ab
    print('f(x)=0 => x≈%.10f'%ab)
x=sp.symbols('x');
def G(x): return x**3 
A,B=-.1,.1; E=10**(-4)
find_root(G,A,B,E)
def F(x): return sp.log(20/sp.sqrt(.009))-1.5*(sp.exp(x/3)+sp.exp(-x/3))-x; 
A,B=0,2; E=10**(-4)
find_root(F,A,B,E)
</script></div><br/>
<div class="compute"><script>
# python / task 2
import sympy as sp
def create_table(f,x0,hx,n,z0,hz,m):
    T=[['n','m','x','z','f(x,z)','f(x,z)=']]
    for i in range(1,n+1):
        for j in range(1,m+1):
            x,z=x0+(i-1)*hx,z0+(j-1)*hz
            T.append([i,j,x,z,f(x,z),f(x,z).n()])
    for t in T: print(t); print(60*'--')
x,z=sp.symbols('x,z');
def f(x,z): return (sp.log(sp.sqrt(sp.pi))+abs(2-x))/(3.3-1/z)+z**(2/3)*sp.cos(x**2)
create_table(f,6.7,.1,4,3.3,.2,3)
</script></div><br/>
<div class="compute"><script>
# python / task 3
import sympy as sp; import pylab as pl; k=sp.symbols('k') 
def controlf(x): return 2*x-x*sp.exp(-x**2)-sp.sin(x)
sumf=lambda x,n: sp.Sum(sp.sign(-1)**(k+1)*x**(2*k+1)*\
                        (1/sp.factorial(k)+1/sp.factorial(2*k+1)),(k,1,n))
x=[.03*i for i in range(1,35)]
controlline=[controlf(.03*i).n() for i in range(1,35)]
def nplot(n):
    sumline=[sumf(.03*i,n).doit().evalf() for i in range(1,35)]
    pl.figure(figsize=(5,5)); ax=pl.gca()
    ax.scatter(x,sumline,label='sum line',s=100);
    ax.scatter(x,controlline,label='control line',c='red');
    pl.title('n=%d'%n); pl.legend(); pl.grid(); pl.show();
nplot(3); nplot(5)
</script></div><br/>
HTML & JavaScript / Task 1
<div class="compute"><script>
%%html

</script></div><br/>
HTML & JavaScript / Task 2
<div class="compute"><script>
%%html

</script></div><br/>
HTML & JavaScript / Task 3
<div class="compute"><script>
%%html

</script></div><br/>
<div class="compute"><script>
%%r
# task 1
find_root<-function (f,a,b,e) {
    if (sign(f(a))==sign(f(b))){
      print('The segment does not possible to use for this decision method')}
    else {
      print('Iteration steps')
      while (b-a>e) {
        ab<-a+(b-a)/2 
        print(c(f(a),f(ab),f(b)))
        if (sign(f(a))!=sign(f(ab))) {
          if (f(ab)==0) {break}
          b<-ab}
        else {a<-ab} } 
    }
   cat(c('f(x)=0 => x≈',ab,'\n'))}
G<-function (x) {return(x^3)}
A<--.1; B<-.1; E<-10^(-4)
find_root(G,A,B,E)
F<-function(x) {return(log(20/sqrt(.009))-1.5*(exp(x/3)+exp(-x/3))-x)} 
A<-0; B<-2; E<-10^(-4)
find_root(F,A,B,E)
</script></div><br/>
<div class="compute"><script>
%%r
# task 2
create_table<-function(f,x0,hx,n,z0,hz,m) {
    cat(c('n | m |  x  |  z  |    f(x,z)\n',replicate(8,'=-='),'\n'))
    for (i in 1:n) {
        for (j in 1:m) {
            x<-x0+(i-1)*hx; z<-z0+(j-1)*hz
            cat(c(i,'|',j,'|',x,'|',z,'|',f(x,z),'\n',replicate(8,'=-='),'\n'))} } }
f<-function(x,z){return((log(sqrt(pi))+abs(2-x))/(3.3-1/z)+z^(2/3)*cos(x^2))}
create_table(f,6.7,.1,4,3.3,.2,3)
</script></div><br/>
<div class="compute"><script>
%%r
# task 3

</script></div><br/>
  </body>
</html>
